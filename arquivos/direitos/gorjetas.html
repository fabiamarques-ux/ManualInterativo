<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gorjetas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #1a202c;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 1rem;
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.05);
        }
        .copy-container {
            display: flex;
            align-items: center;
            position: relative;
        }
        .copy-btn {
            background-color: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            margin-left: 0.5rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .copy-btn svg {
            width: 1.5rem;
            height: 1.5rem;
            fill: #00678F;
            transition: fill 0.3s ease;
        }
        .copy-btn:hover svg {
            fill: #004562;
        }
        .copy-message {
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translate(10px, -50%);
            background-color: #00678F;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        /* MODIFICAÇÃO: Aplicando fundo cinza claro (#f0f4f8) e sombra aos contêineres */
        .drawer-container {
            padding: 1rem;
            background-color: #f0f4f8; /* Fundo cinza claro da tabela */
            border-radius: 0.75rem;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05); /* Sombra sutil */
            margin-top: 1.5rem;
        }
        .drawer-header {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .drawer-content {
            overflow: hidden;
            transition: all 0.5s ease-in-out;
            max-height: 0;
        }
        .drawer-header .arrow-icon {
            transition: transform 0.5s ease-in-out;
        }
        .drawer-header.active .arrow-icon {
            transform: rotate(180deg);
        }
        .table-responsive {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #d1d5db;
        }
        th {
            background-color: #00678F;
            color: white;
        }
        tr:nth-child(odd) {
            background-color: #f0f4f8;
        }
    </style>
</head>
<body>

    <div class="container my-8 relative">
        <img src="https://site.trt19.jus.br/sites/default/files/logo-trt19.png" alt="Logo do TRT19" class="absolute top-4 right-4 w-36 h-auto">
        
        <section id="adicional-insalubridade" class="content-section">
            <h2 class="text-3xl font-bold text-[#00678F] mb-4">Gorjetas</h2>
            <p class="text-gray-700 leading-relaxed text-justify">A gorjeta é o valor oferecido pelo cliente (ou cobrado pelo empregador como taxa de serviço) que se destina aos empregados, seja como gratificação espontânea ou como taxa compulsória. Apesar de não ser salário fixo, a gorjeta integra a remuneração para todos os efeitos legais.</p>
            
            <h3 class="text-xl font-semibold text-black mt-6">Tipos de Gorjetas e Suas Regras</h3>
            <p class="text-gray-700 leading-relaxed text-justify mt-4">A Lei da Gorjeta (Lei 13.419/2017) e a CLT regulamentam a forma como as gorjetas devem ser distribuídas e registradas. É obrigação do empregador anotar as gorjetas recebidas na carteira de trabalho e no contracheque do empregado.</p>
            <p class="text-gray-700 leading-relaxed text-justify mt-4">A retenção de um percentual pela empresa para custeio de encargos sociais, previdenciários e trabalhistas é permitida, desde que respeitados os limites legais e de negociação coletiva.</p>
            <p class="text-gray-700 leading-relaxed text-justify mt-4">Confira na tabela abaixo os dois principais tipos de gorjeta e suas características.</p>
            <div class="table-responsive mt-4">
                <table class="w-full text-sm">
                    <thead>
                        <tr class="bg-[#00678F] text-white">
                            <th class="p-3">Tipo de Gorjeta</th>
                            <th class="p-3">Regra Principal</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr>
                            <td class="p-3">Gorjeta Compulsória (Taxa de Serviço)</td>
                            <td class="p-3">Valor cobrado pela empresa como adicional na conta (Ex: os 10% em bares e restaurantes). É integralmente destinada aos empregados, descontados os percentuais de retenção legalmente permitidos à empresa.</td>
                        </tr>
                        <tr>
                            <td class="p-3">Gorjeta Espontânea</td>
                            <td class="p-3">Valor dado diretamente pelo cliente ao empregado, sem ser cobrado pela empresa. Também integra a remuneração para fins de encargos sociais e reflexos, mas geralmente é de distribuição mais direta.</td>
                        </tr>
                        <tr>
                        <tr>
                            
                    </tbody>
                </table>
            </div>

            <div id="base-legal-drawer" class="drawer-container">
                <div id="base-legal-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Base Legal e Jurisprudência</h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="base-legal-content" class="drawer-content">
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">A regulamentação das gorjetas é dada pela CLT e detalhada pela Lei 13.419/2017.</p>
                    
                    <h5 class="text-lg font-semibold text-gray-800 mt-4">Fontes Normativas</h5>
                    
                    <hr class="my-4 border-gray-300">
                    <h5 class="text-base font-semibold text-gray-800">Consolidação das Leis do Trabalho (CLT):</h5>
                    <ul class="list-disc list-inside text-gray-700 leading-relaxed mt-2 ml-4 space-y-3">
                        <li><strong>Artigo 457, § 3º:</strong>
                            <p class="text-sm italic mt-1 ml-4 border-l-2 border-gray-400 pl-3">Compreendem-se na remuneração do empregado, para todos os efeitos legais, além do salário devido e pago diretamente pelo empregador, como contraprestação do serviço, as gorjetas que receber.</p>
                            <p class="text-sm italic mt-1 ml-4 border-l-2 border-gray-400 pl-3">Considera-se gorjeta não só a importância espontaneamente dada pelo cliente ao empregado, como também o valor cobrado pela empresa, como serviço ou adicional, a qualquer título, e destinado à distribuição aos empregados.</p>
                         </li>

                    </ul>
                    <div class="mt-2 copy-container ml-4">

                    </div>

                    <hr class="my-4 border-gray-300">
                    <h5 class="text-base font-semibold text-gray-800">Lei nº 13.419/2017 (Lei da Gorjeta):</h5>
                    <ul class="list-disc list-inside text-gray-700 leading-relaxed mt-2 ml-4">
                        <li><strong>Art. 1º :</strong>
                            <p class="text-sm italic mt-1 ml-4 border-l-2 border-gray-400 pl-3">Esta Lei altera a Consolidação das Leis do Trabalho (CLT), aprovada pelo Decreto-Lei nº 5.452, de 1º de maio de 1943 , para disciplinar o rateio, entre empregados, da cobrança adicional sobre as despesas em bares, restaurantes, hotéis, motéis e estabelecimentos similares.</p>
                        </li>
                    </ul>
                    <div class="mt-2 copy-container ml-4">

                    </div>
                    
                    <hr class="my-6 border-gray-300">

                    <h5 class="text-lg font-semibold text-gray-800">Jurisprudência</h5>
                    
                    <h6 class="text-base font-semibold text-gray-800 mt-4">Integração na Remuneração (TST)</h6>
                    <div class="p-4 bg-gray-100 rounded-md mt-2 border border-gray-300">
                        <p class="font-bold text-sm">Súmula 354 do TST:</p>
                        <p class="text-sm mt-1 italic">
                            Tese: As gorjetas, cobradas pelo empregador na nota de serviço ou oferecidas espontaneamente pelos clientes, integram a remuneração do empregado, não servindo de base de cálculo para as parcelas de aviso-prévio, adicional noturno, horas extras e repouso semanal remunerado (RSR). 
                        </p>
                    </div>
                    <div class="mt-2 copy-container ml-4">

                    </div>
                </div>
            </div>
            <div id="base-calculo-drawer" class="drawer-container">
                <div id="base-calculo-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Base de Cálculo e Deduções</h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="base-calculo-content" class="drawer-content">
                    <h5 class="text-lg font-semibold text-black mt-2">Integração na Remuneração</h5>
                    <p class="text-gray-700 leading-relaxed text-justify mt-2">O valor total da gorjeta distribuída ao empregado, sem a parte retida pela empresa, deve ser somado ao salário fixo para compor a base de cálculo de todos os encargos trabalhistas e sociais, exceto para o cálculo de horas extras (Súmula 354 do TST). </p>
                    
                    <h5 class="text-lg font-semibold text-black mt-6">Deduções</h5>
                    <p class="text-gray-700 leading-relaxed text-justify mt-2">Por integrar a remuneração, sobre o valor da gorjeta incidem as deduções legais, como a contribuição para o **INSS (Instituto Nacional do Seguro Social)** e o **Imposto de Renda (IRPF)**. Essas deduções são aplicadas sobre o valor total da remuneração, que é a soma do salário base e da gorjeta recebida.</p>
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">**Exemplo de Deduções (INSS e IR):**</p>
                    <p class="text-gray-700 leading-relaxed text-justify">Vamos considerar um salário-base de **R$ 2.000,00** e uma gorjeta de **R$ 300,00** recebida no mês.</p>
                    <ul class="list-disc list-inside text-gray-700 mt-2">
                        <li>**Remuneração total (Base de Cálculo):** R$ 2.000,00 + R$ 300,00 = **R$ 2.300,00**</li>
                        <li>**Dedução de INSS:** Com base na tabela progressiva, a alíquota de INSS para essa faixa de remuneração é de, por exemplo, **11%**. O valor a ser descontado seria: R$ 2.300,00 x 0,11 = **R$ 253,00**.</li>
                        <li>**Base de cálculo para IRPF:** A base de cálculo do Imposto de Renda é a remuneração total menos a dedução do INSS: R$ 2.300,00 - R$ 253,00 = **R$ 2.047,00**.</li>
                        <li>**Dedução de IRPF:** Se a alíquota para essa faixa de renda for de, por exemplo, **7,5%**, e a parcela a deduzir for de **R$ 158,40** (valor hipotético da tabela progressiva), o cálculo do IR será: (R$ 2.047,00 x 0,075) - R$ 158,40 = **R$ 153,52** - R$ 158,40 = **R$ -4,88**. Neste caso hipotético, o valor seria R$ 0,00, pois não há imposto a pagar.</li>
                    </ul>
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">É importante ressaltar que as alíquotas e as faixas de dedução do INSS e do IRPF mudam periodicamente. O exemplo acima é apenas uma simulação.</p>
                </div>
            </div>

            <div id="verbas-reflexas-drawer" class="drawer-container">
                <div id="verbas-reflexas-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Verbas Reflexas</h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="verbas-reflexas-content" class="drawer-content">
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">A gorjeta, por integrar a remuneração (Art. 457, § 3º, da CLT), deve ser considerada no cálculo de todas as verbas que são apuradas sobre a remuneração. O valor utilizado é a média duodecimal das gorjetas recebidas no período de apuração. Confira as principais verbas reflexas:</p>
                    <p class="text-gray-700 leading-relaxed text-justify mt-2">A Súmula 354 do TST estabelece uma exceção importante: a gorjeta **não gera reflexos no cálculo das horas extras**.</p>

                    <table
                        class="w-full mt-4 text-sm text-gray-700 border-collapse border border-gray-300 rounded-md overflow-hidden">
                        <thead>
                            <tr class="bg-gray-200">
                                <th class="py-2 px-4 text-left border-b border-gray-300 w-1/3">Verba Trabalhista</th>
                                <th class="py-2 px-4 text-left border-b border-gray-300 w-2/3">Reflexo da Gorjeta</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-300">
                                <td class="py-2 px-4 font-medium">13º Salário</td>
                                <td class="py-2 px-4">Integra o cálculo do 13º Salário (integral e proporcional) pela média duodecimal.</td>
                            </tr>
                            <tr class="border-b border-gray-300">
                                <td class="py-2 px-4 font-medium">Férias + 1/3</td>
                                <td class="py-2 px-4">Integra o cálculo das Férias (vencidas e proporcionais) e o adicional de 1/3 pela média do período.</td>
                            </tr>
                            <tr class="border-b border-gray-300">
                                <td class="py-2 px-4 font-medium">Aviso Prévio</td>
                                <td class="py-2 px-4">Não integra a base de remuneração para cálculo do Aviso Prévio (trabalhado ou indenizado).</td>
                            </tr>
                            <tr class="border-b border-gray-300">
                                <td class="py-2 px-4 font-medium">FGTS (Depósito Mensal e Multa)</td>
                                <td class="py-2 px-4">Incide sobre a gorjeta, compondo a base de cálculo para o depósito mensal de 8% e para a Multa de 40%.</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4 font-medium">Descanso Semanal Remunerado (DSR)</td>
                                <td class="py-2 px-4">Não gera reflexo, pois o DSR já está embutido no cálculo da gorjeta (ver Lei 13.419/2017).</td>
                            </tr>
                        </tbody>
                    </table>

                    <hr class="my-4 border-gray-300">
                    <p class="text-gray-700 leading-relaxed text-justify mt-2"><strong>Atenção:</strong> A Súmula 354 do TST define expressamente que as gorjetas **NÃO** servem de base de cálculo para as horas extras, embora integrem a remuneração para os demais efeitos legais.</p>
                </div>
            </div>
            <div id="calculadora-gorjetas-drawer" class="drawer-container">
                <div id="calculadora-gorjetas-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Calculadora (Simulação)</h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="calculadora-gorjetas-content" class="drawer-content">
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">Use a simulação abaixo para estimar o valor máximo que a empresa pode reter das gorjetas, conforme a Lei 13.419/2017. O restante deve ser distribuído aos empregados.</p>
                    <div class="mt-4">
                        <label for="valorTotalGorjetasInput" class="block text-sm font-medium text-gray-700">Valor Total de Gorjetas Arrecadadas (mês)</label>
                        <input type="text" id="valorTotalGorjetasInput" class="mt-1 block w-full rounded-md border-gray-300 p-2 focus:ring-[#00678F] focus:border-[#00678F]" placeholder="Ex: 5.000,00" value="">
                    </div>
                    <div class="mt-4">
                        <label for="regimeTributarioSelect" class="block text-sm font-medium text-gray-700">Regime de Tributação Federal da Empresa</label>
                        <select id="regimeTributarioSelect" class="mt-1 block w-full rounded-md border-gray-300 p-2 focus:ring-[#00678F] focus:border-[#00678F]">
                            <option value="0.20">Simples Nacional (Até 20%)</option>
                            <option value="0.33" selected>Outros Regimes (Até 33%)</option>
                        </select>
                    </div>
                    <div class="mt-4 flex items-center">
                        <button id="calculateGorjetasBtn" class="px-4 py-2 bg-[#00678F] text-white rounded-md hover:bg-[#004562] transition duration-300 shadow-md">
                            Simular Retenção
                        </button>
                    </div>
                    <div id="gorjetasResult" class="mt-4 p-4 bg-white rounded-lg border border-gray-200">
                        Seu resultado aparecerá aqui.
                    </div>
                </div>
            </div>


            <div id="pje-calc-drawer" class="drawer-container">
                <div id="pje-calc-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Lançamento no PJe-Calc </h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="pje-calc-content" class="drawer-content">
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">A seguir, confira o passo a passo para o
                        lançamento da verba no PJe-Calc, utilizando a opção "Expresso":</p>

                    <ol class="list-decimal list-inside text-gray-700 leading-relaxed mt-4 ml-4 space-y-3">
                        <li>
                            <strong class="text-gray-800">Acessar Verbas e Escolher Lançamento:</strong> No menu de
                            navegação à esquerda, clique na opção <u>Verbas</u> para iniciar o lançamento. Após o
                            comando,
                            será exibida a tela para escolha do Lançamento da Verba. Escolha a opção <u>Expresso</u>.
                            <img src="imagens_direitos/verbas.png"
                                alt="Tela do PJe-Calc - Passo 1: Acessar a opção Verbas no menu lateral e clicar em Expresso na seção Lançamento."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                        <li>
                            <strong class="text-gray-800">Seleção da Verba:</strong> O sistema abrirá as opções de
                            verbas, escolha a verba <u>Gorjeta</u> e clique no botão <u>Salvar</u>
                            <img src="imagens_direitos/gorjeta1.png"
                                alt="Tela do PJe-Calc - Verbas Principais: Selecionar Saldo de Salário"
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                        <li>
                            <strong class="text-gray-800">Quadro de Verbas e Ações:</strong> O sistema exibirá um quadro
                            com os campos:
                            <ul class="list-disc list-inside text-gray-700 leading-relaxed mt-2 ml-4">
                                <li class="ml-8 flex items-center">
                                <li>Ações - contendo as opções de configurações da verba selecionada (parâmetros,
                                    ocorrências e
                                    exclusão)
                                    <img src="imagens_direitos/telaacoes.png"
                                        alt="Ícones de Ações: Parâmetros (folha com seta), Ocorrências (folha com checks), Excluir (X vermelho)"
                                        class="icon-small" style="width: 72px; height: auto;">
                                </li>
                                <li class="ml-8 flex items-center">
                                    - Parâmetros da Verba <img src="imagens_direitos/telaparametros.png"
                                        alt="Ícone de Parâmetros" class="icon-small">
                                </li>
                                <li class="ml-8 flex items-center">
                                    - Ocorrências da Verba <img src="imagens_direitos/telaocorrencias.png"
                                        alt="Ícone de Ocorrências" class="icon-small">
                                </li>
                                <li class="ml-8 flex items-center">
                                    - Excluir <img src="imagens_direitos/telaexcluir.png" alt="Ícone de Excluir"
                                        class="icon-small">
                                </li>
                                <li>Verba Principal - verba selecionada para lançamento.</li>
                                <li>Verba Reflexa - em que ao clicar no botão <u>Exibir</u> serão listadas todas as
                                    verbas
                                    reflexas ligadas a Verba Principal.</li>
                            </ul>
                            <img src="imagens_direitos/gorjeta2.png"
                                alt="Tela do PJe-Calc - Verba Saldo de Salário selecionada com as opções de Ações e Verba Reflexa."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                        <li>
                            <strong class="text-gray-800">Parametrização da Verba:</strong> Ao clicar no botão
                            <u>Parâmetros da Verba</u> serão exibidas todas as configurações necessárias para a
                            parametrização
                            da Verba Principal.
                            <img src="imagens_direitos/gorjeta3.png"
                                alt="Tela do PJe-Calc - Detalhes da Verba Saldo de Salário: Parâmetros, Base de Cálculo, Divisor e Multiplicador."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                        <li>
                            <strong class="text-gray-800">Registro de Ocorrências:</strong> Ao clicar no botão
                            <u>Ocorrências da Verba</u> serão exibidas todas as configurações necessárias para registro
                            das
                            ocorrências da Verba Principal.
                            <img src="imagens_direitos/gorjeta4.png"
                                alt="Tela do PJe-Calc - Dados de Ocorrências: Detalhamento da data inicial, data final e valor calculado da verba."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                    </ol>

                </div>

        </section>
    </div>

    <script>
        // Função para copiar o texto de um elemento com feedback visual
        function copyTextFromElement(elementId, buttonElement) {
            const element = document.getElementById(elementId);
            if (!element) return;
            const textToCopy = element.textContent.replace('...', ''); // Remove '...' para copiar o link completo

            const tempInput = document.createElement('input');
            tempInput.value = textToCopy;
            document.body.appendChild(tempInput);
            tempInput.select();
            
            try {
                document.execCommand('copy');
                // Criar e exibir a mensagem de sucesso
                const message = document.createElement('span');
                message.textContent = 'Copiado!';
                message.className = 'copy-message';
                // Posicionamento ajustado para funcionar dentro da gaveta
                message.style.position = 'absolute';
                message.style.left = 'calc(100% + 10px)';
                message.style.top = '50%';
                
                buttonElement.parentElement.appendChild(message);
                
                // Animar e remover a mensagem após 1 segundo
                setTimeout(() => {
                    message.style.opacity = '1';
                }, 10);
                setTimeout(() => {
                    message.style.opacity = '0';
                    setTimeout(() => message.remove(), 300);
                }, 1000);

            } catch (err) {
                console.error('Falha ao copiar o texto:', err);
            } finally {
                document.body.removeChild(tempInput);
            }
        }
    
        // Função para formatar o valor de entrada conforme o usuário digita
        function formatInput() {
            const inputElements = document.querySelectorAll('input[type="text"]');
            inputElements.forEach(input => {
                input.addEventListener('input', (e) => {
                    let value = e.target.value;
                    // Remove todos os caracteres que não sejam dígitos
                    value = value.replace(/\D/g, '');
                    
                    // Formata com vírgula para centavos e pontos para milhares
                    if (value.length > 2) {
                        value = value.replace(/(\d+)(\d{2})$/, '$1,$2');
                    }
                    if (value.length > 6) {
                        value = value.replace(/(\d)(?=(\d{3})+,)/g, '$1.');
                    }
                    e.target.value = value;
                });
            });
        }
        
        // Chamada da função de formatação
        formatInput();

        // Função para calcular a retenção e distribuição de gorjetas (SIMULAÇÃO)
        function calculateGorjetas() {
            const valorTotalGorjetasInput = document.getElementById('valorTotalGorjetasInput');
            const regimeTributarioSelect = document.getElementById('regimeTributarioSelect');
            const resultDiv = document.getElementById('gorjetasResult');

            // Substitui pontos por nada e vírgula por ponto para parsear como float
            const rawValorTotal = valorTotalGorjetasInput.value.replace(/\./g, '').replace(',', '.');
            const valorTotalGorjetas = parseFloat(rawValorTotal);
            const percentualRetencaoMaximo = parseFloat(regimeTributarioSelect.value);
            const percentualRetencaoMaximoFormatado = (percentualRetencaoMaximo * 100).toFixed(0) + '%';
            const regime = regimeTributarioSelect.options[regimeTributarioSelect.selectedIndex].text;

            if (isNaN(valorTotalGorjetas) || valorTotalGorjetas <= 0) {
                resultDiv.textContent = 'Por favor, insira um valor total de gorjetas válido.';
                return;
            }

            const valorMaximoRetencao = valorTotalGorjetas * percentualRetencaoMaximo;
            const valorMinimoDistribuicao = valorTotalGorjetas - valorMaximoRetencao;
            
            // Função auxiliar para formatar em moeda brasileira
            const formatCurrency = (value) => value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            // Exibe o resultado formatado
            resultDiv.innerHTML = `
                <h5 class="text-lg font-semibold text-black mb-2">Resultado da Simulação</h5>
                <p><strong>Regime de Tributação:</strong> ${regime}</p>
                <p><strong>Total de Gorjetas Arrecadadas:</strong> ${formatCurrency(valorTotalGorjetas)}</p>
                <p><strong>Percentual Máximo de Retenção:</strong> ${percentualRetencaoMaximoFormatado}</p>
                <p class="mt-2 text-red-700"><strong>Valor Máximo que a Empresa Pode Reter:</strong> ${formatCurrency(valorMaximoRetencao)}</p>
                <p class="text-green-700"><strong>Valor Mínimo para Distribuição aos Empregados:</strong> ${formatCurrency(valorMinimoDistribuicao)}</p>
                <p class="mt-3 text-sm text-gray-500">
                    *A retenção visa custear encargos sociais, previdenciários e trabalhistas. O valor final distribuído pode variar conforme o acordo coletivo.
                </p>
            `;
        }

        // Adiciona o event listener ao botão de calcular
        const calculateBtn = document.getElementById('calculateGorjetasBtn');
        if (calculateBtn) {
            calculateBtn.addEventListener('click', calculateGorjetas);
        }
        
        // Lógica para as gavetas expansíveis
        function setupDrawer(drawerId) {
            const header = document.getElementById(`${drawerId}-header`);
            const content = document.getElementById(`${drawerId}-content`);
            if (header && content) {
                header.addEventListener('click', () => {
                    const isExpanded = header.classList.toggle('active');
                    if (isExpanded) {
                        // Calcula a altura do conteúdo com margem de segurança
                        content.style.maxHeight = content.scrollHeight + 30 + "px"; 
                    } else {
                        content.style.maxHeight = '0';
                    }
                });
            }
        }
        
        // Configura as gavetas restantes
        setupDrawer('base-legal'); // Base Legal (ID Padronizado)
        setupDrawer('base-calculo'); // Base de Cálculo e Deduções
        setupDrawer('verbas-reflexas'); // Reflexos (ID Padronizado)
        setupDrawer('calculadora-gorjetas'); // Calculadora (ID Padronizado)
        // CORREÇÃO: Alteração do ID para 'pje-calc'
        setupDrawer('pje-calc'); // Lançamento no PJe-Calc
    </script>
</body>
</html>