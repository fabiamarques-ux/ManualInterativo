<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gratificação por Assiduidade</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            color: #1a202c;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 1rem;
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.05);
        }

        .copy-container {
            display: flex;
            align-items: center;
            position: relative;
        }

        .copy-btn {
            background-color: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            margin-left: 0.5rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .copy-btn svg {
            width: 1.5rem;
            height: 1.5rem;
            fill: #00678F;
            transition: fill 0.3s ease;
        }

        .copy-btn:hover svg {
            fill: #004562;
        }

        .copy-message {
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translate(10px, -50%);
            background-color: #00678F;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        /* MODIFICAÇÃO: Aplicando fundo cinza claro (#f0f4f8) e sombra aos contêineres */
        .drawer-container {
            padding: 1rem;
            background-color: #f0f4f8;
            /* Fundo cinza claro da tabela */
            border-radius: 0.75rem;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
            /* Sombra sutil */
            margin-top: 1.5rem;
        }

        .drawer-header {
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .drawer-content {
            overflow: hidden;
            transition: all 0.5s ease-in-out;
            max-height: 0;
        }

        .drawer-header .arrow-icon {
            transition: transform 0.5s ease-in-out;
        }

        .drawer-header.active .arrow-icon {
            transform: rotate(180deg);
        }

        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #d1d5db;
        }

        th {
            background-color: #00678F;
            color: white;
        }

        tr:nth-child(odd) {
            background-color: #f0f4f8;
        }
    </style>
</head>

<body>

    <div class="container my-8 relative">
        <img src="https://site.trt19.jus.br/sites/default/files/logo-trt19.png" alt="Logo do TRT19"
            class="absolute top-4 right-4 w-36 h-auto">

        <section id="gratificacao-assiduidade" class="content-section">
            <h2 class="text-3xl font-bold text-[#00678F] mb-4">Gratificação por Assiduidade</h2>
            <p class="text-gray-700 leading-relaxed text-justify">A Gratificação por Assiduidade é um adicional salarial
                concedido ao empregado como incentivo e prêmio por sua pontualidade e ausência de faltas injustificadas
                no serviço durante um período determinado. Ela visa reconhecer e estimular a boa conduta do trabalhador.
            </p>

            <p class="text-gray-700 leading-relaxed text-justify mt-4">A Gratificação por Assiduidade, assim como outras
                verbas criadas por negociação, geralmente é um direito estabelecido por meio de Convenções Coletivas
                de Trabalho (CCT), Acordos Coletivos (ACT) ou por Regulamento Interno da Empresa.</p>
            <p class="text-gray-700 leading-relaxed text-justify mt-4">A natureza jurídica (salarial ou indenizatória) e
                a obrigatoriedade de integração à remuneração para fins de cálculo de outras verbas dependem da forma
                como ela é paga e do que a norma coletiva (CCT/ACT) ou o regulamento da empresa determinam. Em caso de
                habitualidade, a jurisprudência tende a reconhecer a natureza salarial.</p>

            <div class="table-responsive mt-4">
                <table class="w-full text-sm">
                    <thead>

                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr>

                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="base-legal-drawer" class="drawer-container">
                <div id="base-legal-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Base Legal e Jurisprudência</h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="base-legal-content" class="drawer-content">
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">
                        O direito à Gratificação por Assiduidade deve ser buscado na CCT/ACT da categoria ou no
                        Regulamento da Empresa.
                        <br><br>
                        <strong>Fonte Normativa</strong>
                        <br><br>
                    <h5 class="text-base font-semibold text-gray-800">Consolidação das Leis do Trabalho (CLT) - Regra
                        Geral:</h5>
                    <ul class="list-disc list-inside mt-2 text-gray-700 leading-relaxed ml-4 space-y-3">
                        <li>
                            <strong>Artigo 457, § 1º:</strong>
                            <p class="text-sm italic mt-1 ml-4 border-l-2 border-gray-400 pl-3">Integram o salário a
                                importância fixa estipulada, as gratificações legais e as comissões pagas pelo
                                empregador."</p>
                        </li>
                        <li>
                            <strong>Atenção:</strong>
                            <p class="text-sm italic mt-1 ml-4 border-l-2 border-gray-400 pl-3">A reforma trabalhista
                                trouxe a possibilidade de cláusulas normativas definirem se a parcela tem natureza
                                salarial ou indenizatória, mesmo que haja habitualidade, o que deve ser conferido.</p>
                        </li>
                    </ul>
                    <br>
                    <hr class="my-6 border-gray-300">
                    <h5 class="text-base font-semibold text-gray-800">Jurisprudência</h5>
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">
                        A jurisprudência sobre Gratificação por Assiduidade é variável e depende da redação exata da
                        norma coletiva que a instituiu. É fundamental verificar se a parcela é considerada prêmio ou
                        salário.
                    </p>
                    <div class="p-4 bg-gray-100 rounded-md mt-4 border border-gray-300">
                        <p class="text-sm mt-1 italic"> "PRÊMIO. EXIGÊNCIA DE 'DESEMPENHO SUPERIOR AO ORDINARIAMENTE
                            ESPERADO NO EXERCÍCIO DAS ATIVIDADES DO TRABALHADOR'. NATUREZA JURÍDICA SALARIAL SE O
                            PAGAMENTO DECORRE DE CONDUTA NATURAL E NÃO EXTRAORDINÁRIA, COMO POR EXEMPLO PELA ASSIDUIDADE
                            DO EMPREGADO NO SERVIÇO. No caso de pagamento de verba pela assiduidade do empregado, nítido
                            o seu caráter salarial, pois a assiduidade é o que ordinariamente se espera do empregado,
                            por se constituir inclusive em condição natural da própria relação de empreg1o."
                            — (TRT da 12ª Região. Processo $\text{nº}$ 0000856-19.2020.5.12.0061. Publicação:
                            31/03/2021)

                        </p>
                    </div>

                    </p>
                </div>
            </div>
            <div id="base-calculo-drawer" class="drawer-container">
                <div id="base-calculo-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Base de Cálculo e Deduções</h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="base-calculo-content" class="drawer-content">
                    <h5 class="text-lg font-semibold text-black mt-2">Base de Cálculo</h5>
                    <p class="text-gray-700 leading-relaxed text-justify mt-2">O cálculo da Gratificação por Assiduidade
                        é definido pela norma coletiva ou regulamento da empresa. Pode ser um valor fixo, um percentual
                        sobre o salário-base ou vinculado à performance de assiduidade em um período (mensal,
                        trimestral, anual).</p>

                    <p class="text-gray-700 leading-relaxed text-justify mt-4">Exemplo Simplificado de Cálculo (Valor
                        Fixo):</p>
                    <p class="text-gray-700 leading-relaxed text-justify">Considerando um valor fixo mensal de R$
                        100,00 para o empregado que não tiver nenhuma falta injustificada no mês.</p>
                    <ul class="list-disc list-inside text-gray-700 mt-2">
                        <li>Condição Atendida: R$ 100,00</li>
                        <li>Condição Não Atendida: R$ 0,00</li>
                    </ul>

                    <h5 class="text-lg font-semibold text-black mt-6">Deduções</h5>
                    <p class="text-gray-700 leading-relaxed text-justify mt-2">Se a Gratificação por Assiduidade tiver
                        natureza salarial, ela integrará a base de cálculo para as deduções legais, como a
                        contribuição para o INSS e o Imposto de Renda (IRPF). Se tiver natureza
                        indenizatória e estiver em conformidade com o Art. 457, §§ 2º e 4º da CLT, não incidirá.</p>
                    <p class="text-gray-700 leading-relaxed text-justify mt-4 font-semibold">
                        A verificação da natureza jurídica da Gratificação por Assiduidade é crucial para determinar a
                        incidência de INSS e IRPF.
                    </p>
                </div>
            </div>

            <div id="verbas-reflexas-drawer" class="drawer-container">
                <div id="verbas-reflexas-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Verbas Reflexas</h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="verbas-reflexas-content" class="drawer-content">
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">A Gratificação por Assiduidade somente
                        gerará reflexos se tiver sido paga com habitualidade e se lhe for reconhecida a natureza
                        salarial (Art. 457, § 1º, da CLT), ou se a norma coletiva que a criou determinar expressamente
                        a sua integração. Caso a verba tenha natureza indenizatória, não haverá reflexos.</p>
                    <p class="text-gray-700 leading-relaxed text-justify mt-2">O valor a ser integrado será calculado
                        pela média dos valores recebidos no período de apuração, se for variável.</p>

                    <table
                        class="w-full mt-4 text-sm text-gray-700 border-collapse border border-gray-300 rounded-md overflow-hidden">
                        <thead>
                            <tr class="bg-gray-200">
                                <th class="py-2 px-4 text-left border-b border-gray-300 w-1/3">Verba Trabalhista</th>
                                <th class="py-2 px-4 text-left border-b border-gray-300 w-2/3">Possível Reflexo da
                                    Gratificação por Assiduidade</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-300">
                                <td class="py-2 px-4 font-medium">13º Salário</td>
                                <td class="py-2 px-4">Integra o cálculo do 13º Salário (integral e proporcional) pela
                                    média duodecimal (se habitual e salarial).</td>
                            </tr>
                            <tr class="border-b border-gray-300">
                                <td class="py-2 px-4 font-medium">Férias + 1/3</td>
                                <td class="py-2 px-4">Integra o cálculo das Férias (vencidas e proporcionais) e o
                                    adicional de 1/3 pela média do período aquisitivo (se habitual e salarial).</td>
                            </tr>
                            <tr class="border-b border-gray-300">
                                <td class="py-2 px-4 font-medium">Aviso Prévio</td>
                                <td class="py-2 px-4">Integra a base de remuneração para cálculo do Aviso Prévio
                                    (trabalhado ou indenizado) pela média duodecimal (se habitual e salarial).</td>
                            </tr>
                            <tr class="border-b border-gray-300">
                                <td class="py-2 px-4 font-medium">FGTS (Depósito Mensal e Multa)</td>
                                <td class="py-2 px-4">Incide sobre o valor da gratificação (se salarial), compondo a
                                    base de cálculo para o depósito mensal de 8% e para a Multa de 40%.</td>
                            </tr>
                            <tr>
                                <td class="py-2 px-4 font-medium">Horas Extras</td>
                                <td class="py-2 px-4">Incide sobre o valor da gratificação (se salarial), aumentando o
                                    salário-hora (Súmula 264 do TST).</td>
                            </tr>
                        </tbody>
                    </table>

                    <hr class="my-4 border-gray-300">
                    <p class="text-gray-700 leading-relaxed text-justify mt-2"><strong>Importante:</strong> É
                        indispensável a análise da CCT/ACT ou do regulamento da empresa para verificar a natureza
                        jurídica da Gratificação por Assiduidade, pois a determinação de sua natureza indenizatória pode
                        afastar a incidência de todos os reflexos acima listados.</p>
                </div>
            </div>

            <div id="simulacao-drawer" class="drawer-container">
                <div id="simulacao-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Calculadora (Simulação)</h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="simulacao-content" class="drawer-content">
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">Simule o cálculo da Gratificação por
                        Assiduidade no mês com base na sua política de assiduidade. Regra Simples: Uma ou mais faltas
                        injustificadas no período resultam na perda total do benefício.</p>

                    <div class="mt-4">
                        <label for="valorGratificacaoInput" class="block text-sm font-medium text-gray-700">Valor Base
                            Mensal da Gratificação</label>
                        <input type="text" id="valorGratificacaoInput"
                            class="mt-1 block w-full rounded-md border-gray-300 p-2 focus:ring-[#00678F] focus:border-[#00678F]"
                            placeholder="Ex: 100,00" value="100,00">
                        <p class="text-xs text-gray-500 mt-1">Insira o valor integral previsto (geralmente por CCT/ACT).
                        </p>
                    </div>

                    <div class="mt-4">
                        <label for="faltasInjustificadasInput" class="block text-sm font-medium text-gray-700">Número de
                            Faltas Injustificadas no Mês</label>
                        <input type="number" id="faltasInjustificadasInput"
                            class="mt-1 block w-full rounded-md border-gray-300 p-2 focus:ring-[#00678F] focus:border-[#00678F]"
                            placeholder="0" min="0" value="0">
                        <p class="text-xs text-gray-500 mt-1">Faltas justificadas (médicas, legais) não afetam o
                            cálculo.</p>
                    </div>

                    <div class="mt-4 flex items-center">
                        <button id="calculateAssiduidadeBtn"
                            class="px-4 py-2 bg-[#00678F] text-white rounded-md hover:bg-[#004562] transition duration-300 shadow-md">
                            Calcular Gratificação
                        </button>
                    </div>
                    <div id="assiduidadeResult" class="mt-4 p-4 bg-white rounded-lg border border-gray-200">
                        Seus resultados aparecerão aqui.
                    </div>
                </div>
            </div>
            <div id="pje-calc-drawer" class="drawer-container">
                <div id="pje-calc-header" class="drawer-header">
                    <h4 class="text-xl font-semibold text-[#00678F]">Lançamento no PJe-Calc </h4>
                    <svg class="arrow-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </div>
                <div id="pje-calc-content" class="drawer-content">
                    <p class="text-gray-700 leading-relaxed text-justify mt-4">A seguir, confira o passo a passo para o
                        lançamento da verba no PJe-Calc.</p>

                    <div class="p-3 my-4 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 rounded-md">
                        <p class="font-bold leading-relaxed">
                            ATENÇÃO: Como a verba "Gratificação por Assiduidade" é uma verba que depende de
                            parametrização específica da CCT/ACT, recomenda-se o cadastro via opção "Manual".
                        </p>
                    </div>

                    <ol class="list-decimal list-inside text-gray-700 leading-relaxed mt-4 ml-4 space-y-3">
                        <li>
                            <strong class="text-gray-800">Acessar Verbas e Escolher Lançamento:</strong> No menu de
                            navegação à esquerda, clique na opção <u>Verbas</u> para iniciar o lançamento. Após o
                            comando, será exibida a tela para escolha do Lançamento da Verba. Escolha a opção
                            <u>Manual</u>.
                            <img src="imagens_direitos/cadastronovaverba1.png"
                                alt="Tela do PJe-Calc - Passo 1: Acessar a opção Verbas no menu lateral e clicar em Manual na seção Lançamento."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                        <li>
                            <strong class="text-gray-800">Acessar o cadastro de configuação da Verba:</strong> O sistema
                            exibirá a tela de parâmetros da verba com os campos em branco para preenchimento. Cadastre o
                            nome da verba, por exemplo, "Gratificação por Assiduidade", e escolha entre os Assuntos
                            CNJ a opção relativa ao novo cadastro. Preencha
                            devidamente os demais parâmetros (em especial a natureza salarial/indenizatória) e ao final
                            clique no botão <u>Salvar</u>.
                            <img src="imagens_direitos/cadastronovaverba2.png"
                                alt="Tela do PJe-Calc - Passo 2: Configuração da Gratificação por Assiduidade via lançamento Manual."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                        <li>
                            <strong class="text-gray-800">Quadro de Verbas e Ações:</strong> Após o cadastramento da
                            nova verba, o sistema exibirá um quadro
                            com os campos:
                            <ul class="list-disc list-inside text-gray-700 leading-relaxed mt-2 ml-4">
                                <li class="ml-8 flex items-center">
                                <li>Ações - contendo as opções de configurações da verba selecionada (parâmetros,
                                    ocorrências e exclusão)
                                    <img src="imagens_direitos/telaacoes.png"
                                        alt="Ícones de Ações: Parâmetros (folha com seta), Ocorrências (folha com checks), Excluir (X vermelho)"
                                        class="icon-small" style="width: 72px; height: auto;">
                                </li>
                                <li class="ml-8 flex items-center">
                                    - Parâmetros da Verba <img src="imagens_direitos/telaparametros.png"
                                        alt="Ícone de Parâmetros" class="icon-small">
                                </li>
                                <li class="ml-8 flex items-center">
                                    - Ocorrências da Verba <img src="imagens_direitos/telaocorrencias.png"
                                        alt="Ícone de Ocorrências" class="icon-small">
                                </li>
                                <li class="ml-8 flex items-center">
                                    - Excluir <img src="imagens_direitos/telaexcluir.png" alt="Ícone de Excluir"
                                        class="icon-small">
                                </li>
                                <li>Verba Principal - verba selecionada para lançamento (Gratificação por Assiduidade).
                                </li>
                                <li>Verba Reflexa - em que ao clicar no botão <u>Exibir</u> serão listadas todas as
                                    verbas
                                    reflexas ligadas a Verba Principal.</li>
                            </ul>
                            <img src="imagens_direitos/assiduidade1.png"
                                alt="Tela do PJe-Calc - Verba Gratificação por Assiduidade selecionada com as opções de Ações e Verba Reflexa."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                        <li>
                            <strong class="text-gray-800">Parametrização da Verba:</strong> Ao clicar no botão
                            <u>Parâmetros da Verba</u> serão exibidas todas as configurações necessárias para a
                            parametrização
                            da Verba Principal.
                            <img src="imagens_direitos/assiduidade2.png"
                                alt="Tela do PJe-Calc - Detalhes da Verba Gratificação por Assiduidade: Parâmetros, Base de Cálculo, Divisor e Multiplicador."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                        <li>
                            <strong class="text-gray-800">Registro de Ocorrências:</strong> Ao clicar no botão
                            <u>Ocorrências da Verba</u> serão exibidas todas as configurações necessárias para registro
                            das
                            ocorrências da Verba Principal.
                            <img src="imagens_direitos/assiduidade3.png"
                                alt="Tela do PJe-Calc - Dados de Ocorrências da Gratificação por Assiduidade."
                                class="w-full h-auto my-4 rounded-lg shadow-md">
                        </li>
                    </ol>

                </div>

        </section>
    </div>

    <script>
        // Função para copiar o texto de um elemento com feedback visual
        function copyTextFromElement(elementId, buttonElement) {
            const element = document.getElementById(elementId);
            if (!element) return;
            const textToCopy = element.textContent.replace('...', ''); // Remove '...' para copiar o link completo

            const tempInput = document.createElement('input');
            tempInput.value = textToCopy;
            document.body.appendChild(tempInput);
            tempInput.select();

            try {
                document.execCommand('copy');
                // Criar e exibir a mensagem de sucesso
                const message = document.createElement('span');
                message.textContent = 'Copiado!';
                message.className = 'copy-message';
                // Posicionamento ajustado para funcionar dentro da gaveta
                message.style.position = 'absolute';
                message.style.left = 'calc(100% + 10px)';
                message.style.top = '50%';

                buttonElement.parentElement.appendChild(message);

                // Animar e remover a mensagem após 1 segundo
                setTimeout(() => {
                    message.style.opacity = '1';
                }, 10);
                setTimeout(() => {
                    message.style.opacity = '0';
                    setTimeout(() => message.remove(), 300);
                }, 1000);

            } catch (err) {
                console.error('Falha ao copiar o texto:', err);
            } finally {
                document.body.removeChild(tempInput);
            }
        }

        // Função para formatar o valor de entrada conforme o usuário digita (mantida para a funcionalidade anterior, mas ajustada abaixo)
        function formatInput(inputElement) {
            let value = inputElement.value;
            // Remove tudo que não for dígito e vírgula
            value = value.replace(/[^\d,]/g, '');

            // Substitui a vírgula por ponto para cálculo
            value = value.replace(',', '.');

            // Permite apenas um ponto decimal
            const parts = value.split('.');
            if (parts.length > 2) {
                value = parts.shift() + '.' + parts.join('');
            }

            return parseFloat(value) || 0;
        }


        // Lógica da Calculadora de Gratificação por Assiduidade
        document.addEventListener('DOMContentLoaded', () => {
            const valorGratificacaoInput = document.getElementById('valorGratificacaoInput');
            const faltasInjustificadasInput = document.getElementById('faltasInjustificadasInput');
            const calculateBtn = document.getElementById('calculateAssiduidadeBtn');
            const resultDiv = document.getElementById('assiduidadeResult');

            // Função auxiliar para formatar em R$
            const formatCurrency = (value) => {
                return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
            };


            calculateBtn.addEventListener('click', () => {
                // 1. Coletar e validar dados
                const valorGratificacao = formatInput(valorGratificacaoInput);
                const faltasInjustificadas = parseInt(faltasInjustificadasInput.value) || 0;

                if (valorGratificacao <= 0) {
                    resultDiv.innerHTML = `<p class="text-red-600">⚠️ Por favor, insira um valor base para a gratificação.</p>`;
                    return;
                }

                let valorFinalGratificacao = 0;
                let mensagem = "";

                // 2. Lógica da Gratificação por Assiduidade (Regra: Uma falta anula o benefício)
                if (faltasInjustificadas > 0) {
                    valorFinalGratificacao = 0;
                    mensagem = `❌ O empregado teve ${faltasInjustificadas} falta(s) injustificada(s) no mês. Conforme a regra de assiduidade simulada (zero tolerância), a gratificação não é devida.`;
                } else {
                    valorFinalGratificacao = valorGratificacao;
                    mensagem = `✅ O empregado não teve faltas injustificadas. A gratificação é devida no valor integral.`;
                }


                // 3. Exibir Resultados
                resultDiv.innerHTML = `
                    <h5 class="font-bold text-[#00678F] mb-3">Resultado do Cálculo da Gratificação (Mês)</h5>
                    <div class="space-y-2">
                        <p class="font-medium text-gray-800">Valor Base da Gratificação: <span class="text-sm font-normal">${formatCurrency(valorGratificacao)}</span></p>
                        <p class="font-medium text-gray-800">Faltas Injustificadas no Mês: <span class="text-sm font-normal">${faltasInjustificadas}</span></p>
                        <hr class="my-2 border-gray-300">
                        
                        <p class="text-lg font-bold text-gray-900">Valor Final da Gratificação Devida:</p>
                        <p class="text-3xl font-extrabold ${valorFinalGratificacao > 0 ? 'text-green-700' : 'text-red-700'}">${formatCurrency(valorFinalGratificacao)}</p>

                        <div class="p-3 bg-gray-100 rounded-md mt-4 text-sm border border-gray-300">
                            <p class="font-bold">Regra Aplicada:</p>
                            <p>${mensagem}</p>
                            <p class="mt-2 text-xs italic">Atenção: A regra de perda total em caso de qualquer falta injustificada é uma simulação. O regramento exato deve ser verificado na CCT/ACT ou Regulamento da Empresa.</p>
                        </div>
                    </div>
                `;
            });

            // Function to set up the visual formatting on blur/initial load
            function setupInputFormatting() {
                // Configura input de valor (Gratificação)
                valorGratificacaoInput.addEventListener('blur', (e) => {
                    const value = formatInput(e.target);
                    e.target.value = value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                });

                // Mantém a formatação ao digitar para o valor da gratificação
                valorGratificacaoInput.addEventListener('input', (e) => {
                    let value = e.target.value.replace(/[^\d,]/g, '');

                    // Remove vírgula se houver mais de uma
                    const parts = value.split(',');
                    if (parts.length > 2) {
                        value = parts[0] + ',' + parts.slice(1).join('');
                    }

                    e.target.value = value;
                });

                // Inicializa os valores com o formato brasileiro
                const initialValue = formatInput(valorGratificacaoInput);
                if (initialValue > 0) {
                    valorGratificacaoInput.value = initialValue.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                }
            }

            setupInputFormatting();

        });


        // Lógica para as gavetas expansíveis
        function setupDrawer(drawerId) {
            const header = document.getElementById(`${drawerId}-header`);
            const content = document.getElementById(`${drawerId}-content`);
            if (header && content) {
                header.addEventListener('click', () => {
                    const isExpanded = header.classList.toggle('active');
                    if (isExpanded) {
                        // Calcula a altura do conteúdo com margem de segurança
                        content.style.maxHeight = content.scrollHeight + 30 + "px";
                    } else {
                        content.style.maxHeight = '0';
                    }
                });
            }
        }

        // Configura as gavetas
        setupDrawer('base-legal');
        setupDrawer('base-calculo');
        setupDrawer('verbas-reflexas');
        setupDrawer('simulacao');
        setupDrawer('pje-calc');
    </script>
</body>

</html>